<!DOCTYPE html>
<html lang="en-us">

<head>
  

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>

<link rel="shortcut icon" type="image/png" href="/favicon.ico"/>


<link rel='stylesheet' href='/style.min.0122b8d14d9247c2ac34fa87ad975f23eb927ad958d8ae6bda2caccd9ac9eb42.css'>


<script src='/main.min.db37c27117ff8400e5e30549f6806d2bc825668b596d81316c6148417f59bc72.js' async></script>


  <title>ActivityPub - Mastodon documentation</title>

  <meta property="og:type" content="article">
  <meta property="og:url" content="https://docs.joinmastodon.org/spec/activitypub/">

  
    <meta name="description" content="A decentralized social networking protocol based upon the ActivityStreams 2.0 data format and JSON-LD.">
    <meta property="og:description" content="A decentralized social networking protocol based upon the ActivityStreams 2.0 data format and JSON-LD.">
    <meta name="twitter:description" content="A decentralized social networking protocol based upon the ActivityStreams 2.0 data format and JSON-LD.">
  

  <meta name="twitter:title" content="ActivityPub">
  <meta name="twitter:site" content="@joinmastodon">

  <link rel="canonical" href="https://docs.joinmastodon.org/spec/activitypub/">
</head>

<body>
  <div class="container sidebar-layout">
    <nav class="sidebar"><a class="brand" href="/">
  <img class="link-logo" src="/brand.svg" alt="Mastodon" />
</a>

<input id="mobile-nav-toggle" class="mobile-nav-toggle" type="checkbox">
<label for="mobile-nav-toggle">
    <span class="menu-open">
        <i class="fa fa-times"></i> Close
    </span>
    <span class="menu-close">
        <i class="fa fa-bars"></i> Menu
    </span>
</label>

<ul>
  
  
    <li>
      
        <a href="/" class="">What is Mastodon?</a>
      

      
    </li>
  
    <li>
      
        <span class="sub-title">Using Mastodon</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/user/signup/" class="">Signing up for an account</a>

              
            </li>
          
            <li>
              <a href="/user/profile/" class="">Setting up your profile</a>

              
            </li>
          
            <li>
              <a href="/user/posting/" class="">Posting to your profile</a>

              
            </li>
          
            <li>
              <a href="/user/network/" class="">Using the network features</a>

              
            </li>
          
            <li>
              <a href="/user/moderating/" class="">Dealing with unwanted content</a>

              
            </li>
          
            <li>
              <a href="/user/discoverability/" class="">Promoting yourself and others</a>

              
            </li>
          
            <li>
              <a href="/user/preferences/" class="">Set your preferences</a>

              
            </li>
          
            <li>
              <a href="/user/contacts/" class="">More settings</a>

              
            </li>
          
            <li>
              <a href="/user/external/" class="">Using Mastodon externally</a>

              
            </li>
          
            <li>
              <a href="/user/moving/" class="">Moving or leaving accounts</a>

              
            </li>
          
            <li>
              <a href="/user/run-your-own/" class="">Running your own server</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">Running Mastodon</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/admin/prerequisites/" class="">Preparing your machine</a>

              
            </li>
          
            <li>
              <a href="/admin/install/" class="">Installing from source</a>

              
            </li>
          
            <li>
              <a href="/admin/config/" class="">Configuring your environment</a>

              
            </li>
          
            <li>
              <a href="/admin/elasticsearch/" class="">Configuring full-text search</a>

              
            </li>
          
            <li>
              <a href="/admin/optional/" class="">Installing optional features</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/admin/optional/object-storage/" class="">Object storage</a>
                    </li>
                  
                    <li>
                      <a href="/admin/optional/tor/" class="">Onion services</a>
                    </li>
                  
                    <li>
                      <a href="/admin/optional/captcha/" class="">Captcha</a>
                    </li>
                  
                    <li>
                      <a href="/admin/optional/sso/" class="">Single Sign On</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/admin/setup/" class="">Setting up your new instance</a>

              
            </li>
          
            <li>
              <a href="/admin/tootctl/" class="">Using the admin CLI</a>

              
            </li>
          
            <li>
              <a href="/admin/upgrading/" class="">Upgrading to a new release</a>

              
            </li>
          
            <li>
              <a href="/admin/backups/" class="">Backing up your server</a>

              
            </li>
          
            <li>
              <a href="/admin/migrating/" class="">Migrating to a new machine</a>

              
            </li>
          
            <li>
              <a href="/admin/scaling/" class="">Scaling up your server</a>

              
            </li>
          
            <li>
              <a href="/admin/moderation/" class="">Moderation actions</a>

              
            </li>
          
            <li>
              <a href="/admin/troubleshooting/" class="">Troubleshooting errors</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/admin/troubleshooting/index-corruption/" class="">Database index corruption</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/admin/roles/" class="">Roles</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">Developing Mastodon apps</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/client/intro/" class="">Getting started with the API</a>

              
            </li>
          
            <li>
              <a href="/client/public/" class="">Playing with public data</a>

              
            </li>
          
            <li>
              <a href="/client/token/" class="">Obtaining client app access</a>

              
            </li>
          
            <li>
              <a href="/client/authorized/" class="">Logging in with an account</a>

              
            </li>
          
            <li>
              <a href="/client/libraries/" class="">Libraries and implementations</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">Contributing to Mastodon</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/dev/overview/" class="">Technical overview</a>

              
            </li>
          
            <li>
              <a href="/dev/setup/" class="">Setting up a dev environment</a>

              
            </li>
          
            <li>
              <a href="/dev/code/" class="">Code structure</a>

              
            </li>
          
            <li>
              <a href="/dev/routes/" class="">Routes</a>

              
            </li>
          
            <li>
              <a href="/dev/disclosure/" class="">Bug bounties and responsible disclosure</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">Spec compliance</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/spec/activitypub/" class="active">ActivityPub</a>

              
            </li>
          
            <li>
              <a href="/spec/webfinger/" class="">WebFinger</a>

              
            </li>
          
            <li>
              <a href="/spec/security/" class="">Security</a>

              
            </li>
          
            <li>
              <a href="/spec/microformats/" class="">Microformats</a>

              
            </li>
          
            <li>
              <a href="/spec/oauth/" class="">OAuth</a>

              
            </li>
          
            <li>
              <a href="/spec/bearcaps/" class="">Bearcaps</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">REST API</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/api/guidelines/" class="">Guidelines and best practices</a>

              
            </li>
          
            <li>
              <a href="/api/oauth-scopes/" class="">OAuth Scopes</a>

              
            </li>
          
            <li>
              <a href="/api/rate-limits/" class="">Rate limits</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">API Methods</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/methods/apps/" class="">apps</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/methods/oauth/" class="">oauth</a>
                    </li>
                  
                    <li>
                      <a href="/methods/emails/" class="">emails</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/methods/accounts/" class="">accounts</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/methods/bookmarks/" class="">bookmarks</a>
                    </li>
                  
                    <li>
                      <a href="/methods/favourites/" class="">favourites</a>
                    </li>
                  
                    <li>
                      <a href="/methods/mutes/" class="">mutes</a>
                    </li>
                  
                    <li>
                      <a href="/methods/blocks/" class="">blocks</a>
                    </li>
                  
                    <li>
                      <a href="/methods/domain_blocks/" class="">domain_blocks</a>
                    </li>
                  
                    <li>
                      <a href="/methods/filters/" class="">filters</a>
                    </li>
                  
                    <li>
                      <a href="/methods/reports/" class="">reports</a>
                    </li>
                  
                    <li>
                      <a href="/methods/follow_requests/" class="">follow_requests</a>
                    </li>
                  
                    <li>
                      <a href="/methods/endorsements/" class="">endorsements</a>
                    </li>
                  
                    <li>
                      <a href="/methods/featured_tags/" class="">featured_tags</a>
                    </li>
                  
                    <li>
                      <a href="/methods/preferences/" class="">preferences</a>
                    </li>
                  
                    <li>
                      <a href="/methods/followed_tags/" class="">followed_tags</a>
                    </li>
                  
                    <li>
                      <a href="/methods/suggestions/" class="">suggestions</a>
                    </li>
                  
                    <li>
                      <a href="/methods/tags/" class="">tags</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/methods/profile/" class="">profile</a>

              
            </li>
          
            <li>
              <a href="/methods/statuses/" class="">statuses</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/methods/media/" class="">media</a>
                    </li>
                  
                    <li>
                      <a href="/methods/polls/" class="">polls</a>
                    </li>
                  
                    <li>
                      <a href="/methods/scheduled_statuses/" class="">scheduled_statuses</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/methods/timelines/" class="">timelines</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/methods/conversations/" class="">conversations</a>
                    </li>
                  
                    <li>
                      <a href="/methods/lists/" class="">lists</a>
                    </li>
                  
                    <li>
                      <a href="/methods/markers/" class="">markers</a>
                    </li>
                  
                    <li>
                      <a href="/methods/streaming/" class="">streaming</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/methods/notifications/" class="">notifications</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/methods/push/" class="">push</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/methods/search/" class="">search</a>

              
            </li>
          
            <li>
              <a href="/methods/instance/" class="">instance</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/methods/trends/" class="">trends</a>
                    </li>
                  
                    <li>
                      <a href="/methods/directory/" class="">directory</a>
                    </li>
                  
                    <li>
                      <a href="/methods/custom_emojis/" class="">custom_emojis</a>
                    </li>
                  
                    <li>
                      <a href="/methods/announcements/" class="">announcements</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/methods/admin/" class="">admin</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/methods/admin/accounts/" class="">accounts</a>
                    </li>
                  
                    <li>
                      <a href="/methods/admin/canonical_email_blocks/" class="">canonical_email_blocks</a>
                    </li>
                  
                    <li>
                      <a href="/methods/admin/dimensions/" class="">dimensions</a>
                    </li>
                  
                    <li>
                      <a href="/methods/admin/domain_allows/" class="">domain_allows</a>
                    </li>
                  
                    <li>
                      <a href="/methods/admin/domain_blocks/" class="">domain_blocks</a>
                    </li>
                  
                    <li>
                      <a href="/methods/admin/email_domain_blocks/" class="">email_domain_blocks</a>
                    </li>
                  
                    <li>
                      <a href="/methods/admin/ip_blocks/" class="">ip_blocks</a>
                    </li>
                  
                    <li>
                      <a href="/methods/admin/measures/" class="">measures</a>
                    </li>
                  
                    <li>
                      <a href="/methods/admin/reports/" class="">reports</a>
                    </li>
                  
                    <li>
                      <a href="/methods/admin/retention/" class="">retention</a>
                    </li>
                  
                    <li>
                      <a href="/methods/admin/trends/" class="">trends</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/methods/proofs/" class="">proofs</a>

              
            </li>
          
            <li>
              <a href="/methods/oembed/" class="">oembed</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">API Entities</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/entities/Account/" class="">Account</a>

              
            </li>
          
            <li>
              <a href="/entities/Admin_Account/" class="">Admin::Account</a>

              
            </li>
          
            <li>
              <a href="/entities/Admin_CanonicalEmailBlock/" class="">Admin::CanonicalEmailBlock</a>

              
            </li>
          
            <li>
              <a href="/entities/Admin_Cohort/" class="">Admin::Cohort</a>

              
            </li>
          
            <li>
              <a href="/entities/Admin_Dimension/" class="">Admin::Dimension</a>

              
            </li>
          
            <li>
              <a href="/entities/Admin_DomainAllow/" class="">Admin::DomainAllow</a>

              
            </li>
          
            <li>
              <a href="/entities/Admin_DomainBlock/" class="">Admin::DomainBlock</a>

              
            </li>
          
            <li>
              <a href="/entities/Admin_EmailDomainBlock/" class="">Admin::EmailDomainBlock</a>

              
            </li>
          
            <li>
              <a href="/entities/Admin_Ip/" class="">Admin::Ip</a>

              
            </li>
          
            <li>
              <a href="/entities/Admin_IpBlock/" class="">Admin::IpBlock</a>

              
            </li>
          
            <li>
              <a href="/entities/Admin_Measure/" class="">Admin::Measure</a>

              
            </li>
          
            <li>
              <a href="/entities/Admin_Report/" class="">Admin::Report</a>

              
            </li>
          
            <li>
              <a href="/entities/Announcement/" class="">Announcement</a>

              
            </li>
          
            <li>
              <a href="/entities/Application/" class="">Application</a>

              
            </li>
          
            <li>
              <a href="/entities/Context/" class="">Context</a>

              
            </li>
          
            <li>
              <a href="/entities/Conversation/" class="">Conversation</a>

              
            </li>
          
            <li>
              <a href="/entities/CustomEmoji/" class="">CustomEmoji</a>

              
            </li>
          
            <li>
              <a href="/entities/DomainBlock/" class="">DomainBlock</a>

              
            </li>
          
            <li>
              <a href="/entities/Error/" class="">Error</a>

              
            </li>
          
            <li>
              <a href="/entities/ExtendedDescription/" class="">ExtendedDescription</a>

              
            </li>
          
            <li>
              <a href="/entities/FamiliarFollowers/" class="">FamiliarFollowers</a>

              
            </li>
          
            <li>
              <a href="/entities/FeaturedTag/" class="">FeaturedTag</a>

              
            </li>
          
            <li>
              <a href="/entities/Filter/" class="">Filter</a>

              
            </li>
          
            <li>
              <a href="/entities/FilterKeyword/" class="">FilterKeyword</a>

              
            </li>
          
            <li>
              <a href="/entities/FilterResult/" class="">FilterResult</a>

              
            </li>
          
            <li>
              <a href="/entities/FilterStatus/" class="">FilterStatus</a>

              
            </li>
          
            <li>
              <a href="/entities/IdentityProof/" class="">IdentityProof</a>

              
            </li>
          
            <li>
              <a href="/entities/Instance/" class="">Instance</a>

              
            </li>
          
            <li>
              <a href="/entities/List/" class="">List</a>

              
            </li>
          
            <li>
              <a href="/entities/Marker/" class="">Marker</a>

              
            </li>
          
            <li>
              <a href="/entities/MediaAttachment/" class="">MediaAttachment</a>

              
            </li>
          
            <li>
              <a href="/entities/Notification/" class="">Notification</a>

              
            </li>
          
            <li>
              <a href="/entities/Poll/" class="">Poll</a>

              
            </li>
          
            <li>
              <a href="/entities/Preferences/" class="">Preferences</a>

              
            </li>
          
            <li>
              <a href="/entities/PreviewCard/" class="">PreviewCard</a>

              
            </li>
          
            <li>
              <a href="/entities/Reaction/" class="">Reaction</a>

              
            </li>
          
            <li>
              <a href="/entities/Relationship/" class="">Relationship</a>

              
            </li>
          
            <li>
              <a href="/entities/RelationshipSeveranceEvent/" class="">RelationshipSeveranceEvent</a>

              
            </li>
          
            <li>
              <a href="/entities/Report/" class="">Report</a>

              
            </li>
          
            <li>
              <a href="/entities/Role/" class="">Role</a>

              
            </li>
          
            <li>
              <a href="/entities/Rule/" class="">Rule</a>

              
            </li>
          
            <li>
              <a href="/entities/ScheduledStatus/" class="">ScheduledStatus</a>

              
            </li>
          
            <li>
              <a href="/entities/Search/" class="">Search</a>

              
            </li>
          
            <li>
              <a href="/entities/Status/" class="">Status</a>

              
            </li>
          
            <li>
              <a href="/entities/StatusEdit/" class="">StatusEdit</a>

              
            </li>
          
            <li>
              <a href="/entities/StatusSource/" class="">StatusSource</a>

              
            </li>
          
            <li>
              <a href="/entities/Suggestion/" class="">Suggestion</a>

              
            </li>
          
            <li>
              <a href="/entities/Tag/" class="">Tag</a>

              
            </li>
          
            <li>
              <a href="/entities/Token/" class="">Token</a>

              
            </li>
          
            <li>
              <a href="/entities/Translation/" class="">Translation</a>

              
            </li>
          
            <li>
              <a href="/entities/V1_Filter/" class="">V1::Filter</a>

              
            </li>
          
            <li>
              <a href="/entities/V1_Instance/" class="">V1::Instance</a>

              
            </li>
          
            <li>
              <a href="/entities/WebPushSubscription/" class="">WebPushSubscription</a>

              
            </li>
          
        </ul>
      
    </li>
  
</ul>
</nav>
    <main>
  <h1>ActivityPub</h1>  
  
    <p>A decentralized social networking protocol based upon the ActivityStreams 2.0 data format and JSON-LD.</p>
  
  <aside>
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#status">Status federation</a>
          <ul>
            <li><a href="#supported-activities-for-statuses">Supported activities for statuses</a></li>
            <li><a href="#payloads">Payloads</a></li>
            <li><a href="#sanitization">HTML sanitization</a></li>
            <li><a href="#properties-used">Properties used</a></li>
          </ul>
        </li>
        <li><a href="#profile">Profile federation</a>
          <ul>
            <li><a href="#supported-activities-for-profiles">Supported activities for profiles</a></li>
            <li><a href="#properties-used-1">Properties used</a></li>
          </ul>
        </li>
        <li><a href="#contexts">JSON-LD Contexts and Extensions</a>
          <ul>
            <li><a href="#toot">Mastodon extensions (<code>toot:</code>)</a></li>
            <li><a href="#as">ActivityStreams extensions (<code>as:</code>)</a></li>
            <li><a href="#schema">Schema.org extensions (<code>schema:</code>)</a></li>
            <li><a href="#sec">W3ID Security Vocabulary (<code>sec:</code>)</a></li>
          </ul>
        </li>
        <li><a href="#extensions-defined-using-activitystreams-vocabulary">Extensions defined using ActivityStreams vocabulary</a>
          <ul>
            <li><a href="#Block">Remote blocking (<code>Block</code>)</a></li>
            <li><a href="#Flag">Reporting profiles and posts (<code>Flag</code>)</a></li>
            <li><a href="#Move">Account migration (<code>Move</code>)</a></li>
            <li><a href="#Question">Polls</a></li>
            <li><a href="#Mention">Mentions for addressing and notifications</a></li>
          </ul>
        </li>
        <li><a href="#extensions-not-defined-by-activitystreams">Extensions not defined by ActivityStreams</a>
          <ul>
            <li><a href="#publicKey">Public key</a></li>
            <li><a href="#featured">Featured collection</a></li>
            <li><a href="#featuredTags">Featured tags</a></li>
            <li><a href="#PropertyValue">Profile metadata</a></li>
            <li><a href="#IdentityProof">Identity proofs</a></li>
            <li><a href="#discoverable">Discoverability flag</a></li>
            <li><a href="#suspended">Suspended flag</a></li>
            <li><a href="#Hashtag">Hashtags</a></li>
            <li><a href="#Emoji">Custom emojis</a></li>
            <li><a href="#focalPoint">Focal points</a></li>
            <li><a href="#blurhash">Blurhash</a></li>
            <li><a href="#sensitive">Sensitive content</a></li>
          </ul>
        </li>
        <li><a href="#other-functionality">Other functionality</a>
          <ul>
            <li><a href="#secure-mode">Secure mode</a></li>
            <li><a href="#follower-synchronization-mechanism">Follower synchronization mechanism</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </aside>
  <div class="e-content">
    <h2 id="status">Status federation</h2>
<a href="https://github.com/mastodon/mastodon/blob/main/app/lib/activitypub/activity.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  app/lib/activitypub/activity.rb
</a>

<h3 id="supported-activities-for-statuses">Supported activities for statuses</h3>
<dl>
<dt>Create</dt>
<dd>Transformed into a status and saved into database</dd>
<dt>Delete</dt>
<dd>Removes a status from the database</dd>
<dt>Like</dt>
<dd>Transformed into a favourite on a status</dd>
<dt>Announce</dt>
<dd>Transformed into a boost on a status</dd>
<dt>Update</dt>
<dd>Refresh vote count on polls. As of Mastodon 3.5.0: edit statuses when the <code>updated</code> timestamp is present.</dd>
<dt>Undo</dt>
<dd>Undo a previous Like or Announce.</dd>
<dt>Flag</dt>
<dd>Transformed into a report to the moderation team. See the <a href="#Flag">Reports</a> extension for more information.</dd>
</dl>
<h3 id="payloads">Payloads</h3>
<p>The first-class Object types supported by Mastodon are <code>Note</code> and <code>Question</code>.</p>
<ul>
<li>Notes are transformed into regular statuses.</li>
<li>Questions are transformed into a poll status. See the <a href="#Question">Polls</a> extension for more information.</li>
</ul>
<p>Some other Object types are converted as best as possible:</p>
<ul>
<li>Article</li>
<li>Page</li>
<li>Image</li>
<li>Audio</li>
<li>Video</li>
<li>Event</li>
</ul>
<p>The transformer uses <code>content</code> if available, or <code>name</code> if not, in order to generate status text. The <code>url</code> will be appended. The <code>summary</code> property will be used as the CW text. The <code>icon</code> will be used as a thumbnail.</p>
<h3 id="sanitization">HTML sanitization</h3>
<a href="https://github.com/mastodon/mastodon/blob/main/lib/sanitize_ext/sanitize_config.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  lib/sanitize_ext/sanitize_config.rb
</a>

<p>Mastodon sanitizes incoming HTML in order to not break assumptions for API client developers. Supported elements will be kept as-is, and unsupported elements will be converted or removed. Supported attributes will be kept, and all other attributes will be stripped. The following elements and attributes are supported:</p>
<ul>
<li><code>&lt;p&gt;</code></li>
<li><code>&lt;span&gt;</code> (<code>class</code>)</li>
<li><code>&lt;br&gt;</code></li>
<li><code>&lt;a&gt;</code> (<code>href</code>, <code>rel</code>, <code>class</code>)</li>
<li>lists will be converted to <code>&lt;p&gt;</code>, and list items will be separated with <code>&lt;br&gt;</code></li>
</ul>
<p>Since Mastodon v4.2, the following elements and attributes are supported:</p>
<ul>
<li><code>&lt;p&gt;</code></li>
<li><code>&lt;span&gt;</code> (<code>class</code>)</li>
<li><code>&lt;br&gt;</code></li>
<li><code>&lt;a&gt;</code> (<code>href</code>, <code>rel</code>, <code>class</code>)</li>
<li><code>&lt;del&gt;</code></li>
<li><code>&lt;pre&gt;</code></li>
<li><code>&lt;code&gt;</code></li>
<li><code>&lt;em&gt;</code></li>
<li><code>&lt;strong&gt;</code></li>
<li><code>&lt;b&gt;</code></li>
<li><code>&lt;i&gt;</code></li>
<li><code>&lt;u&gt;</code></li>
<li><code>&lt;ul&gt;</code></li>
<li><code>&lt;ol&gt;</code> (<code>start</code>, <code>reversed</code>)</li>
<li><code>&lt;li&gt;</code> (<code>value</code>)</li>
<li><code>&lt;blockquote&gt;</code></li>
<li>headings will be converted to <code>&lt;strong&gt;</code> and then wrapped in <code>&lt;p&gt;</code></li>
</ul>
<p>The sanitizer will keep classes if they begin with microformats prefixes or are semantic classes:</p>
<ul>
<li>h-*</li>
<li>p-*</li>
<li>u-*</li>
<li>dt-*</li>
<li>e-*</li>
<li>mention</li>
<li>hashtag</li>
<li>ellipsis</li>
<li>invisible</li>
</ul>
<p>Links will be kept if the protocol is supported, and converted to text otherwise. The following link protocols are supported:</p>
<ul>
<li>http</li>
<li>https</li>
<li>dat</li>
<li>dweb</li>
<li>ipfs</li>
<li>ipns</li>
<li>ssb</li>
<li>gopher</li>
<li>xmpp</li>
<li>magnet</li>
<li>gemini</li>
</ul>
<h3 id="properties-used">Properties used</h3>
<dl>
<dt>content</dt>
<dd>Used as status text</dd>
<dt>name</dt>
<dd>Used as status text, if <code>content</code> is not provided on a transformed Object type</dd>
<dt>summary</dt>
<dd>Used as CW text</dd>
<dt>sensitive</dt>
<dd>Used to determine whether status media or text should be hidden by default. See the <a href="#sensitive">Sensitive content</a> extension section for more information about <code>as:sensitive</code></dd>
<dt>inReplyTo</dt>
<dd>Used for threading a status as a reply to another status</dd>
<dt>published</dt>
<dd>Used as status date</dd>
<dt>url</dt>
<dd>Used for status permalinks, and also appended to status text for transformed Objects</dd>
<dt>attributedTo</dt>
<dd>Used to determine the profile which authored the status</dd>
<dt>to/cc</dt>
<dd>Used to determine audience and visibility of a status, in combination with mentions. See <a href="#Mention">Mentions for adddressing and notifications</a></dd>
<dt>tag</dt>
<dd>Used to mark up mentions and hashtags.</dd>
<dt>tag[].type</dt>
<dd>Either <code>Mention</code>, <code>Hashtag</code>, or <code>Emoji</code> is currently supported. See the <a href="#Hashtag">Hashtag</a> and <a href="#Emoji">Custom emoji</a> extension sections for more information</dd>
<dt>tag[].name</dt>
<dd>The plain-text Webfinger address of a profile Mention (<code>@user</code> or <code>@user@domain</code>), or the plain-text Hashtag (<code>#tag</code>), or the custom Emoji shortcode (<code>:thounking:</code>)</dd>
<dt>tag[].href</dt>
<dd>The URL of the actor or tag</dd>
<dt>attachment</dt>
<dd>Used to include attached images, videos, or audio.</dd>
<dt>attachment[].url</dt>
<dd>Used to fetch the media attachment</dd>
<dt>attachment[].summary</dt>
<dd>Used as media description</dd>
<dt>attachment[].blurhash</dt>
<dd>Used to generate a blurred preview image corresponding to the colors used within the image. See <a href="#blurhash">Blurhash</a> for more details.</dd>
<dt>replies</dt>
<dd>A Collection of statuses that are in reply to the current status. Up to 5 replies from the same server will be fetched upon discovery of a remote status, in order to resolve threads more fully. On Mastodon&rsquo;s side, the first page contains self-replies, and additional pages contain replies from other people.</dd>
</dl>
<h4 id="poll-specific-properties">Poll-specific properties</h4>
<dl>
<dt>endTime</dt>
<dd>The timestamp for when voting will close on the poll</dd>
<dt>closed</dt>
<dd>The timestamp for when voting closed on the poll. The timestamp will likely match the <code>endTime</code> timestamp. If this property is present, the poll is assumed to be closed.</dd>
<dt>votersCount</dt>
<dd>How many people have voted in the poll. Distinct from how many votes have been cast (in the case of multiple-choice polls)</dd>
<dt>oneOf</dt>
<dd>Single-choice poll options</dd>
<dt>anyOf</dt>
<dd>Multiple-choice poll options</dd>
<dt>oneOf/anyOf[].name</dt>
<dd>The poll option&rsquo;s text</dd>
<dt>oneOf/anyOf[].replies.totalItems</dt>
<dd>The poll option&rsquo;s vote count</dd>
</dl>
<h2 id="profile">Profile federation</h2>
<h3 id="supported-activities-for-profiles">Supported activities for profiles</h3>
<dl>
<dt>Follow</dt>
<dd>Indicate interest in receiving status updates from a profile.</dd>
<dt>Accept/Reject</dt>
<dd>Used to approve or deny Follow activities. Unlocked accounts will automatically reply with an Accept, while locked accounts can manually choose whether to approve or deny a follow request.</dd>
<dt>Add/Remove</dt>
<dd>Manage pinned posts and featured collections.</dd>
<dt>Update</dt>
<dd>Refresh account details</dd>
<dt>Delete</dt>
<dd>Remove an account from the database, as well as all of their statuses.</dd>
<dt>Undo</dt>
<dd>Undo a previous Follow, Accept Follow, or Block.</dd>
<dt>Block</dt>
<dd>Signal to a remote server that they should hide your profile from that user. Not guaranteed. See <a href="#Block">Remote blocking</a> for more information.</dd>
<dt>Flag</dt>
<dd>Report a user to their moderation team. See the <a href="#Flag">Reports</a> extension for more information.</dd>
<dt>Move</dt>
<dd>Migrate followers from one account to another. Requires <code>alsoKnownAs</code> to be set on the new account pointing to the old account.</dd>
</dl>
<h3 id="properties-used-1">Properties used</h3>
<dl>
<dt>preferredUsername</dt>
<dd>Used for Webfinger lookup. Must be unique on the domain, and must correspond to a Webfinger <code>acct:</code> URI.</dd>
<dt>name</dt>
<dd>Used as profile display name.</dd>
<dt>summary</dt>
<dd>Used as profile bio.</dd>
<dt>type</dt>
<dd>Assumed to be Person. If type is Application or Service, it will be interpreted as a bot flag.</dd>
<dt>url</dt>
<dd>Used as profile link.</dd>
<dt>icon</dt>
<dd>Used as profile avatar.</dd>
<dt>image</dt>
<dd>Used as profile header.</dd>
<dt>manuallyApprovesFollowers</dt>
<dd>Will be shown as a locked account.</dd>
<dt>discoverable</dt>
<dd>Will be shown in the profile directory. See <a href="#discoverable">Discoverability flag</a>.</dd>
<dt>publicKey</dt>
<dd>Required for signatures. See <a href="#publicKey">Public key</a>.</dd>
<dt>featured</dt>
<dd>Pinned posts. See <a href="#featured">Featured collection</a>.</dd>
<dt>attachment</dt>
<dd>Used for profile fields. See <a href="#PropertyValue">Profile metadata</a> and <a href="#IdentityProof">Identity proofs</a>.</dd>
<dt>alsoKnownAs</dt>
<dd>Required for Move activity.</dd>
<dt>published</dt>
<dd>When the profile was created.</dd>
</dl>
<h2 id="contexts">JSON-LD Contexts and Extensions</h2>
<a href="https://github.com/mastodon/mastodon/blob/main/app/lib/activitypub/adapter.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  app/lib/activitypub/adapter.rb
</a>

<h3 id="toot">Mastodon extensions (<code>toot:</code>)</h3>
<p>Base URI: <code>http://joinmastodon.org/ns#</code></p>
<p>Contains definitions for Mastodon features.</p>
<ul>
<li>toot:Emoji (<code>http://joinmastodon.org/ns#Emoji</code>)</li>
<li>toot:IdentityProof (<code>http://joinmastodon.org/ns#IdentityProof</code>)</li>
<li>toot:blurhash (<code>http://joinmastodon.org/ns#blurhash</code>)</li>
<li>toot:focalPoint (<code>http://joinmastodon.org/ns#focalPoint</code>)</li>
<li>toot:featured (<code>http://joinmastodon.org/ns#featured</code>)</li>
<li>toot:featuredTags (<code>http://joinmastodon.org/ns#featuredTags</code>)</li>
<li>toot:discoverable (<code>http://joinmastodon.org/ns#discoverable</code>)</li>
<li>toot:suspended (<code>http://joinmastodon.org/ns#suspended</code>)</li>
<li>toot:votersCount (<code>http://joinmastodon.org/ns#votersCount</code>)</li>
</ul>
<h3 id="as">ActivityStreams extensions (<code>as:</code>)</h3>
<p>Base URI: <code>https://www.w3.org/ns/activitystreams#</code></p>
<p>Contains ActivityStreams extended properties that have been proposed but not officially adopted yet.</p>
<ul>
<li>as:Hashtag (<code>https://www.w3.org/ns/activitystreams#Hashtag</code>)</li>
<li>as:manuallyApprovesFollowers (<code>https://www.w3.org/ns/activitystreams#manuallyApprovesFollowers</code>)</li>
<li>as:movedTo (<code>https://www.w3.org/ns/activitystreams#movedTo</code>)</li>
<li>as:sensitive (<code>https://www.w3.org/ns/activitystreams#sensitive</code>)</li>
</ul>
<h3 id="schema">Schema.org extensions (<code>schema:</code>)</h3>
<p>Contains properties used for profile metadata.</p>
<p>Base URI: <code>http://schema.org#</code> (incorrect; should be <code>https://schema.org/</code>)</p>
<ul>
<li><a href="https://schema.org/PropertyValue">schema:PropertyValue (<code>http://schema.org#PropertyValue</code>, should be <code>https://schema.org/PropertyValue</code>)</a></li>
<li><a href="https://schema.org/value">schema:value (<code>http://schema.org#value</code>, should be <code>https://schema.org/value</code>)</a></li>
</ul>
<h3 id="sec">W3ID Security Vocabulary (<code>sec:</code>)</h3>
<p>Context: <a href="https://w3id.org/security/v1"><code>https://w3id.org/security/v1</code></a></p>
<p>Used for HTTPS Signatures. Also used for identity proofs. See <a href="/spec/security/">Security</a> for more information.</p>
<ul>
<li><a href="https://w3id.org/security#publicKey">sec:publicKey (<code>https://w3id.org/security#publicKey</code>)</a></li>
<li><a href="https://w3id.org/security#publicKeyPem">sec:publicKeyPem (<code>https://w3id.org/security#publicKeyPem</code>)</a></li>
<li><a href="https://w3id.org/security#owner">sec:owner (<code>https://w3id.org/security#owner</code>)</a></li>
<li><a href="https://w3id.org/security#signature">sec:signature (<code>https://w3id.org/security#signature</code>)</a></li>
<li><a href="https://w3id.org/security#signatureValue">sec:signatureValue (<code>https://w3id.org/security#signatureValue</code>)</a></li>
</ul>
<h4 id="w3id-identity">W3ID Identity</h4>
<p>Context: <a href="https://w3id.org/identity/v1"><code>https://w3id.org/identity/v1</code></a> (offline)</p>
<p>Used for Linked Data Signatures. See <a href="/spec/security/#ld">Security &gt; Linked Data Signatures</a> for more information.</p>
<ul>
<li><a href="http://purl.org/dc/terms/creator">dc:creator (<code>http://purl.org/dc/terms/creator</code>)</a></li>
<li><a href="http://purl.org/dc/terms/created">dc:created (<code>http://purl.org/dc/terms/created</code>)</a></li>
<li><a href="https://w3id.org/security#signature">sec:signature (<code>https://w3id.org/security#signature</code>)</a></li>
<li><a href="https://w3id.org/security#signatureValue">sec:signatureValue (<code>https://w3id.org/security#signatureValue</code>)</a></li>
</ul>
<h2 id="extensions-defined-using-activitystreams-vocabulary">Extensions defined using ActivityStreams vocabulary</h2>
<p>While the Activity Vocabulary defines a wide range of types and terms, ActivityPub only defines side effects for a subset of them. The following activity types have the following side effects when received in a Mastodon inbox.</p>
<h3 id="Block">Remote blocking (<code>Block</code>)</h3>
<p>ActivityPub defines the <code>Block</code> activity for client-to-server (C2S) use-cases, but not for server-to-server (S2S) &ndash; it recommends that servers SHOULD NOT deliver Block activities to their <code>object</code>. However, Mastodon will send this activity when a local user blocks a remote user. When Mastodon receives a <code>Block</code> activity where the <code>object</code> is an actor on the local domain, it will interpret this as a signal to hide the actor&rsquo;s profile and posts from the local user, as well as disallowing mentions of that actor by that local user.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/bd06bb61-01e0-447a-9dc8-95915db9aec8&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Block&#34;</span>,
  <span style="color:#ff79c6">&#34;actor&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/alice&#34;</span>,
  <span style="color:#ff79c6">&#34;object&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/~mallory&#34;</span>,
  <span style="color:#ff79c6">&#34;to&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/~mallory&#34;</span>
}
</code></pre></div><h3 id="Flag">Reporting profiles and posts (<code>Flag</code>)</h3>
<p>To report profiles and/or posts on remote servers, Mastodon will send a <code>Flag</code> activity from the instance actor. The <code>object</code> of this activity contains the user being reported, as well as any posts attached to the report. If a comment is attached to the report, it will be used as the <code>content</code> of the activity.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/ccb4f39a-506a-490e-9a8c-71831c7713a4&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Flag&#34;</span>,
  <span style="color:#ff79c6">&#34;actor&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/actor&#34;</span>,
  <span style="color:#ff79c6">&#34;content&#34;</span>: <span style="color:#f1fa8c">&#34;Please take a look at this user and their posts&#34;</span>,
  <span style="color:#ff79c6">&#34;object&#34;</span>: [
    <span style="color:#f1fa8c">&#34;https://example.com/users/1&#34;</span>,
    <span style="color:#f1fa8c">&#34;https://example.com/posts/380590&#34;</span>,
    <span style="color:#f1fa8c">&#34;https://example.com/posts/380591&#34;</span>
  ],
  <span style="color:#ff79c6">&#34;to&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/users/1&#34;</span>
}
</code></pre></div><h3 id="Move">Account migration (<code>Move</code>)</h3>
<p>Mastodon uses the Move activity to signal that an account has migrated to a different account. For the migration to be considered valid, Mastodon checks that the new account has defined an alias pointing to the old account (via the <code>alsoKnownAs</code> property).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/alice#moves/1&#34;</span>,
  <span style="color:#ff79c6">&#34;actor&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/alice&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Move&#34;</span>,
  <span style="color:#ff79c6">&#34;object&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/alice&#34;</span>,
  <span style="color:#ff79c6">&#34;target&#34;</span>: <span style="color:#f1fa8c">&#34;https://alice.com/users/109835986274379&#34;</span>,
  <span style="color:#ff79c6">&#34;to&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/alice/followers&#34;</span>
}
</code></pre></div><h3 id="Question">Polls</h3>
<a href="https://www.w3.org/TR/activitystreams-vocabulary/#questions" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  Activity Vocabulary §5.4 - Representing Questions
</a>

<p>The ActivityStreams Vocabulary specification describes loosely (non-normatively) how a question might be represented. Mastodon&rsquo;s implementation of polls is somewhat inspired by this section. The following implementation details can be observed:</p>
<ul>
<li><code>Question</code> is used as an <code>Object</code> type instead of as an <code>IntransitiveActivity</code>; rather than being sent directly, it is wrapped in a <code>Create</code> just like any other status.</li>
<li>Poll options are serialized using <code>oneOf</code> or <code>anyOf</code> as an array.
<ul>
<li>Each item in this array has no <code>id</code>, has a <code>type</code> of <code>Note</code>, and has a <code>name</code> representing the text of the poll option.</li>
<li>Each item in this array also has a <code>replies</code> property, representing the responses to this particular poll option. This node has no <code>id</code>, has a <code>type</code> of <code>Collection</code>, and has a <code>totalItems</code> property representing the total number of votes received for this option.</li>
</ul>
</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: [
    <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style="color:#ff79c6">&#34;votersCount&#34;</span>: <span style="color:#f1fa8c">&#34;http://joinmastodon.org/ns#votersCount&#34;</span>
    }
  ],
  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/alice/statuses/1009947848598745&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Question&#34;</span>,
  <span style="color:#ff79c6">&#34;content&#34;</span>: <span style="color:#f1fa8c">&#34;What should I eat for breakfast today?&#34;</span>,
  <span style="color:#ff79c6">&#34;published&#34;</span>: <span style="color:#f1fa8c">&#34;2023-03-05T07:40:13Z&#34;</span>,
  <span style="color:#ff79c6">&#34;endTime&#34;</span>: <span style="color:#f1fa8c">&#34;2023-03-06T07:40:13Z&#34;</span>,
  <span style="color:#ff79c6">&#34;votersCount&#34;</span>: <span style="color:#bd93f9">7</span>,
  <span style="color:#ff79c6">&#34;anyOf&#34;</span>: [
    {
      <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Note&#34;</span>,
      <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;apple&#34;</span>,
      <span style="color:#ff79c6">&#34;replies&#34;</span>: {
        <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Collection&#34;</span>,
        <span style="color:#ff79c6">&#34;totalItems&#34;</span>: <span style="color:#bd93f9">3</span>
      }
    },
    {
      <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Note&#34;</span>,
      <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;orange&#34;</span>,
      <span style="color:#ff79c6">&#34;replies&#34;</span>: {
        <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Collection&#34;</span>,
        <span style="color:#ff79c6">&#34;totalItems&#34;</span>: <span style="color:#bd93f9">7</span>
      }
    },
    {
      <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Note&#34;</span>,
      <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;banana&#34;</span>,
      <span style="color:#ff79c6">&#34;replies&#34;</span>: {
        <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Collection&#34;</span>,
        <span style="color:#ff79c6">&#34;totalItems&#34;</span>: <span style="color:#bd93f9">6</span>
      }
    }
  ]
}
</code></pre></div><ul>
<li>Poll votes are serialized as <code>Create</code> activities, where the <code>object</code> is a <code>Note</code> with a <code>name</code> that exactly matches the <code>name</code> of the poll option. The <code>Note.inReplyTo</code> points to the URI of the <code>Question</code> object.
<ul>
<li>For multiple-choice polls, multiple activities may be sent. Votes will be counted if you have not previously voted for that option.</li>
</ul>
</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/bob#votes/827163/activity&#34;</span>,
  <span style="color:#ff79c6">&#34;to&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/alice&#34;</span>,
  <span style="color:#ff79c6">&#34;actor&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/bob&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Create&#34;</span>,
  <span style="color:#ff79c6">&#34;object&#34;</span>: {
    <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/bob#votes/827163&#34;</span>,
    <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Note&#34;</span>,
    <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;orange&#34;</span>,
    <span style="color:#ff79c6">&#34;attributedTo&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/bob&#34;</span>,
    <span style="color:#ff79c6">&#34;to&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/alice&#34;</span>,
    <span style="color:#ff79c6">&#34;inReplyTo&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/alice/statuses/1009947848598745&#34;</span>
  }
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/bob#votes/827164/activity&#34;</span>,
  <span style="color:#ff79c6">&#34;to&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/alice&#34;</span>,
  <span style="color:#ff79c6">&#34;actor&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/bob&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Create&#34;</span>,
  <span style="color:#ff79c6">&#34;object&#34;</span>: {
    <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/bob#votes/827164&#34;</span>,
    <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Note&#34;</span>,
    <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;banana&#34;</span>,
    <span style="color:#ff79c6">&#34;attributedTo&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/bob&#34;</span>,
    <span style="color:#ff79c6">&#34;to&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/alice&#34;</span>,
    <span style="color:#ff79c6">&#34;inReplyTo&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.example/users/alice/statuses/1009947848598745&#34;</span>
  }
}
</code></pre></div><h3 id="Mention">Mentions for addressing and notifications</h3>
<a href="https://www.w3.org/TR/activitystreams-vocabulary/#microsyntaxes" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  Activity Vocabulary §5.6 - Mentions, Tags, and Other Common Social Microsyntaxes
</a>

<p>In the ActivityStreams Vocabulary, <code>Mention</code> is a subtype of <code>Link</code> that is intended to represent the microsyntax of @mentions. The <code>tag</code> property is intended to add references to other Objects or Links. For Link tags, the <code>name</code> of the Link should be a substring of the natural language properties (<code>name</code>, <code>summary</code>, <code>content</code>) on that object. Wherever such a substring is found, it can be transformed into a hyperlink reference to the <code>href</code>.</p>
<p>However, Mastodon also uses <code>Mention</code> tags for addressing in some cases. Based on the presence or exclusion of Mention tags, and compared to the explicitly declared audiences in <code>to</code> and <code>cc</code>, Mastodon will calculate a visibility level for the post. Additionally, Mastodon requires Mention tags in order to generate a notification. (The mentioned actor must still be included within <code>to</code> or <code>cc</code> explicitly in order to receive the post.)</p>
<ul>
<li><code>public</code>: Public statuses have the <code>as:Public</code> magic collection in <code>to</code></li>
<li><code>unlisted</code>: Unlisted statuses have the <code>as:Public</code> magic collection in <code>cc</code></li>
<li><code>private</code>: Followers-only statuses have an actor&rsquo;s follower collection in <code>to</code> or <code>cc</code>, but do not include the <code>as:Public</code> magic collection</li>
<li><code>limited</code>: Limited-audience statuses have actors in <code>to</code> or <code>cc</code>, at least one of which is not <code>Mention</code>ed in <code>tag</code></li>
<li><code>direct</code>: Mentions-only statuses have actors in <code>to</code> or <code>cc</code>, all of which are <code>Mention</code>ed in <code>tag</code></li>
</ul>
<a href="https://github.com/mastodon/mastodon/blob/main/app/lib/activitypub/activity/create.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  app/lib/activitypub/activity/create.rb
</a>

<a href="https://github.com/mastodon/mastodon/blob/main/app/lib/activitypub/parser/status_parser.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  app/lib/activitypub/parser/status_parser.rb
</a>

<h2 id="extensions-not-defined-by-activitystreams">Extensions not defined by ActivityStreams</h2>
<p>The following features are defined using properties and types that are not defined by ActivityStreams.</p>
<h3 id="publicKey">Public key</h3>
<p>Public keys are used for HTTP Signatures and Linked Data Signatures. This is implemented using an extra property <code>publicKey</code> on actor objects. See <a href="/spec/security/">Security</a> for more information.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: [
    <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    <span style="color:#f1fa8c">&#34;https://w3id.org/security/v1&#34;</span>
  ],
  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.social/users/Gargron&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Person&#34;</span>,
  <span style="color:#ff79c6">&#34;publicKey&#34;</span>: {
    <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.social/users/Gargron#main-key&#34;</span>,
    <span style="color:#ff79c6">&#34;owner&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.social/users/Gargron&#34;</span>,
    <span style="color:#ff79c6">&#34;publicKeyPem&#34;</span>: <span style="color:#f1fa8c">&#34;-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvXc4vkECU2/CeuSo1wtn\nFoim94Ne1jBMYxTZ9wm2YTdJq1oiZKif06I2fOqDzY/4q/S9uccrE9Bkajv1dnkO\nVm31QjWlhVpSKynVxEWjVBO5Ienue8gND0xvHIuXf87o61poqjEoepvsQFElA5ym\novljWGSA/jpj7ozygUZhCXtaS2W5AD5tnBQUpcO0lhItYPYTjnmzcc4y2NbJV8hz\n2s2G8qKv8fyimE23gY1XrPJg+cRF+g4PqFXujjlJ7MihD9oqtLGxbu7o1cifTn3x\nBfIdPythWu5b4cujNsB3m3awJjVmx+MHQ9SugkSIYXV0Ina77cTNS0M2PYiH1PFR\nTwIDAQAB\n-----END PUBLIC KEY-----\n&#34;</span>
  }
}
</code></pre></div><h3 id="featured">Featured collection</h3>
<p>What is known in Mastodon as “pinned statuses”, or statuses that are always featured at the top of people’s profiles, is implemented using an extra property <code>featured</code> on the actor object that points to a <code>Collection</code> of objects.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: [
    <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style="color:#ff79c6">&#34;featured&#34;</span>: {
        <span style="color:#ff79c6">&#34;@id&#34;</span>: <span style="color:#f1fa8c">&#34;http://joinmastodon.org/ns#featured&#34;</span>,
        <span style="color:#ff79c6">&#34;@type&#34;</span>: <span style="color:#f1fa8c">&#34;@id&#34;</span>
      }
    }
  ],

  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/@alice&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Person&#34;</span>,
  <span style="color:#ff79c6">&#34;featured&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/@alice/collections/featured&#34;</span>
}
</code></pre></div><h3 id="featuredTags">Featured tags</h3>
<p>Mastodon allows users to feature specific hashtags on their profile for easy browsing, as a discoverability mechanism. This is implemented using an extra property <code>featuredTags</code> on the actor object that points to a <code>Collection</code> of <code>Hashtag</code> objects specifically.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: [
    <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style="color:#ff79c6">&#34;featuredTags&#34;</span>: {
        <span style="color:#ff79c6">&#34;@id&#34;</span>: <span style="color:#f1fa8c">&#34;http://joinmastodon.org/ns#featuredTags&#34;</span>,
        <span style="color:#ff79c6">&#34;@type&#34;</span>: <span style="color:#f1fa8c">&#34;@id&#34;</span>
      }
    }
  ],

  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/@alice&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Person&#34;</span>,
  <span style="color:#ff79c6">&#34;featuredTags&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/@alice/collections/tags&#34;</span>
}
</code></pre></div><h3 id="PropertyValue">Profile metadata</h3>
<p>Mastodon supports arbitrary profile fields containing name-value pairs. This is implemented using the <code>attachment</code> property on actor objects, with objects in the array having a type of <code>PropertyValue</code> and a <code>value</code> property, both from the schema.org namespace.</p>
<div class="hint hint-warning">
  <div class="hint-icon"><i class="fa fa-exclamation-circle"></i></div>

  As noted above while listing the <a href="#schema">schema.org @context extensions</a>, Mastodon currently incorrectly expects and maps the term <code>schema</code> to the base URI <code>http://schema.org#</code> instead of to the base URI <code>https://schema.org/</code>. Therefore, JSON-LD processors who use the correct context definition will fail to process profile fields correctly.
</div>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: [
    <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style="color:#ff79c6">&#34;schema&#34;</span>: <span style="color:#f1fa8c">&#34;http://schema.org#&#34;</span>,
      <span style="color:#ff79c6">&#34;PropertyValue&#34;</span>: <span style="color:#f1fa8c">&#34;schema:PropertyValue&#34;</span>,
      <span style="color:#ff79c6">&#34;value&#34;</span>: <span style="color:#f1fa8c">&#34;schema:value&#34;</span>
    }
  ],
  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.social/users/Gargron&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Person&#34;</span>,
  <span style="color:#ff79c6">&#34;attachment&#34;</span>: [
    {
      <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;PropertyValue&#34;</span>,
      <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;Patreon&#34;</span>,
      <span style="color:#ff79c6">&#34;value&#34;</span>: <span style="color:#f1fa8c">&#34;&lt;a href=\&#34;https://www.patreon.com/mastodon\&#34; rel=\&#34;me nofollow noopener noreferrer\&#34; target=\&#34;_blank\&#34;&gt;&lt;span class=\&#34;invisible\&#34;&gt;https://www.&lt;/span&gt;&lt;span class=\&#34;\&#34;&gt;patreon.com/mastodon&lt;/span&gt;&lt;span class=\&#34;invisible\&#34;&gt;&lt;/span}&#34;</span>
    },
    {
      <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;PropertyValue&#34;</span>,
      <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;Homepage&#34;</span>,
      <span style="color:#ff79c6">&#34;value&#34;</span>: <span style="color:#f1fa8c">&#34;&lt;a href=\&#34;https://zeonfederated.com\&#34; rel=\&#34;me nofollow noopener noreferrer\&#34; target=\&#34;_blank\&#34;&gt;&lt;span class=\&#34;invisible\&#34;&gt;https://&lt;/span&gt;&lt;span class=\&#34;\&#34;&gt;zeonfederated.com&lt;/span&gt;&lt;span class=\&#34;invisible\&#34;&gt;&lt;/span}&#34;</span>
    }
  ]
}
</code></pre></div><h3 id="IdentityProof">Identity proofs</h3>
<div class="hint hint-warning">
  <div class="hint-icon"><i class="fa fa-exclamation-circle"></i></div>

  This property is currently unused/deprecated due to the removal of Keybase support in Mastodon 3.5: <a href="https://github.com/mastodon/mastodon/pull/17045">https://github.com/mastodon/mastodon/pull/17045</a>
</div>

<p>Mastodon supports integration with identity providers to prove that a profile is linked to a certain identity. This is implemented using the <code>attachment</code> property on actor objects, with objects in the array having a type of <code>IdentityProof</code> from the Mastodon namespace. The object also includes <code>signatureAlgorithm</code> and <code>signatureValue</code> from the W3ID Security Vocabulary namespace.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: [
    <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    <span style="color:#f1fa8c">&#34;https://w3id.org/security/v1&#34;</span>,
    {
      <span style="color:#ff79c6">&#34;IdentityProof&#34;</span>: <span style="color:#f1fa8c">&#34;http://joinmastodon.org/ns#IdentityProof&#34;</span>
    }
  ],
  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.social/users/Gargron&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Person&#34;</span>,
  <span style="color:#ff79c6">&#34;attachment&#34;</span>: [
    {
      <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;IdentityProof&#34;</span>,
      <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;gargron&#34;</span>,
      <span style="color:#ff79c6">&#34;signatureAlgorithm&#34;</span>: <span style="color:#f1fa8c">&#34;keybase&#34;</span>,
      <span style="color:#ff79c6">&#34;signatureValue&#34;</span>: <span style="color:#f1fa8c">&#34;5cfc20c7018f2beefb42a68836da59a792e55daa4d118498c9b1898de7e845690f&#34;</span>
    }
  ]
}
</code></pre></div><h3 id="discoverable">Discoverability flag</h3>
<p>Mastodon allows users to opt-in or opt-out of discoverability features like the profile directory. This flag may also be used as an indicator of the user&rsquo;s preferences toward being included in external discovery services, such as search engines or other indexing tools. If you are implementing such a tool, it is recommended that you respect this property if it is present. This is implemented using an extra property <code>discoverable</code> on objects.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: [
    <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style="color:#ff79c6">&#34;discoverable&#34;</span>: <span style="color:#f1fa8c">&#34;http://joinmastodon.org/ns#discoverable&#34;</span>
    }
  ],
  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://mastodon.social/users/Gargron&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Person&#34;</span>,
  <span style="color:#ff79c6">&#34;discoverable&#34;</span>: <span style="color:#ff79c6">true</span>
}
</code></pre></div><h3 id="suspended">Suspended flag</h3>
<p>Mastodon reports whether a user was locally suspended, for better handling of these accounts. Suspended accounts in Mastodon return empty data. If a remote account is marked as suspended, it cannot be unsuspended locally. Suspended accounts can be targeted by activities such as Update, Undo, Reject, and Delete. This functionality is implemented using an extra property <code>suspended</code> on objects.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: [
    <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style="color:#ff79c6">&#34;suspended&#34;</span>: <span style="color:#f1fa8c">&#34;http://joinmastodon.org/ns#suspended&#34;</span>
    }
  ],
  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/@eve&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Person&#34;</span>,
  <span style="color:#ff79c6">&#34;suspended&#34;</span>: <span style="color:#ff79c6">true</span>
}
</code></pre></div><h3 id="Hashtag">Hashtags</h3>
<p>Similar to the <code>Mention</code> subtype of Link already defined in ActivityStreams, Mastodon will use <code>Hashtag</code> as a subtype of Link in order to surface posts referencing some common topic identified by a string key. The Hashtag has a <code>name</code> containing the #hashtag microsyntax &ndash; a <code>#</code> followed by a string sequence representing a topic. This is similar to the @mention microsyntax, where an <code>@</code> is followed by some string sequence representing a resource (where in Mastodon&rsquo;s case, this resource is expected to be an account). Mastodon will also normalize hashtags to be case-insensitive lowercase strings, performing ASCII folding and removing invalid characters.</p>
<a href="https://github.com/mastodon/mastodon/blob/main/app/lib/hashtag_normalizer.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  app/lib/hashtag_normalizer.rb
</a>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: [
    <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style="color:#ff79c6">&#34;Hashtag&#34;</span>: <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams#Hashtag&#34;</span>
    }
  ],
  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/some-post&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Note&#34;</span>,
  <span style="color:#ff79c6">&#34;attributedTo&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com&#34;</span>,
  <span style="color:#ff79c6">&#34;content&#34;</span>: <span style="color:#f1fa8c">&#34;I love #cats&#34;</span>,
  <span style="color:#ff79c6">&#34;tag&#34;</span>: [
    {
      <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Hashtag&#34;</span>,
      <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;#cats&#34;</span>,
      <span style="color:#ff79c6">&#34;href&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/tagged/cats&#34;</span>
    }
  ]
}
</code></pre></div><h3 id="Emoji">Custom emojis</h3>
<p>Mastodon supports arbitrary emojis by including a <code>tag</code> of the <code>Emoji</code> type. Handling of custom emojis is similar to handling of mentions and hashtags, where the <code>name</code> of the tagged entity is found as a substring of the natural language properties (<code>name</code>, <code>summary</code>, <code>content</code>) and then linked to the local representation of some resource or topic. In the case of emoji shortcodes, the <code>name</code> is replaced by the HTML for an inline image represented by the <code>icon</code> property (where <code>icon.url</code> links to the image resource).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: [
    <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style="color:#ff79c6">&#34;Emoji&#34;</span>: <span style="color:#f1fa8c">&#34;http://joinmastodon.org/ns#Emoji&#34;</span>,
    }
  ],

  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/@alice/hello-world&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Note&#34;</span>,
  <span style="color:#ff79c6">&#34;content&#34;</span>: <span style="color:#f1fa8c">&#34;Hello world :kappa:&#34;</span>,
  <span style="color:#ff79c6">&#34;tag&#34;</span>: [
    {
      <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/emoji/123&#34;</span>,
      <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Emoji&#34;</span>,
      <span style="color:#ff79c6">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;:kappa:&#34;</span>,
      <span style="color:#ff79c6">&#34;icon&#34;</span>: {
        <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Image&#34;</span>,
        <span style="color:#ff79c6">&#34;mediaType&#34;</span>: <span style="color:#f1fa8c">&#34;image/png&#34;</span>,
        <span style="color:#ff79c6">&#34;url&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/files/kappa.png&#34;</span>
      }
    }
  ]
}
</code></pre></div><h3 id="focalPoint">Focal points</h3>
<p>Mastodon supports setting a focal point on uploaded images, so that wherever that image is displayed, the focal point stays in view. This is implemented using an extra property <code>focalPoint</code> on <code>Image</code> objects. The property is an array of two floating points between -1.0 and 1.0, with 0,0 being the center of the image, the first value being x (-1.0 is the left edge, +1.0 is the right edge) and the second value being y (-1.0 is the bottom edge, +1.0 is the top edge). See <a href="/api/guidelines/#focal-points">API Guidelines &gt; Focal points</a> for more information.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: [
    <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style="color:#ff79c6">&#34;focalPoint&#34;</span>: {
        <span style="color:#ff79c6">&#34;@container&#34;</span>: <span style="color:#f1fa8c">&#34;@list&#34;</span>,
        <span style="color:#ff79c6">&#34;@id&#34;</span>: <span style="color:#f1fa8c">&#34;http://joinmastodon.org/ns#focalPoint&#34;</span>
      }
    }
  ],

  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/@alice/hello-world&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Note&#34;</span>,
  <span style="color:#ff79c6">&#34;content&#34;</span>: <span style="color:#f1fa8c">&#34;A picture attached!&#34;</span>,
  <span style="color:#ff79c6">&#34;attachment&#34;</span>: [
    {
      <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Image&#34;</span>,
      <span style="color:#ff79c6">&#34;mediaType&#34;</span>: <span style="color:#f1fa8c">&#34;image/png&#34;</span>,
      <span style="color:#ff79c6">&#34;url&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/files/cats.png&#34;</span>,
      <span style="color:#ff79c6">&#34;focalPoint&#34;</span>: [
        <span style="color:#bd93f9">-0.55</span>,
        <span style="color:#bd93f9">0.43</span>
      ]
    }
  ]
}
</code></pre></div><figure><img src="/assets/focal-points.jpg"
         alt="A demonstration of various focal points and their coordinates."/><figcaption>
            <p>A demonstration of various focal points and their coordinates.</p>
        </figcaption>
</figure>

<p>The focal point of (-0.55, 0.43) in the example above corresponds to a point 55% to the left of center and 43% above center. This focal point should remain visible within the cropped thumbnail, if any cropping is done.</p>
<h3 id="blurhash">Blurhash</h3>
<p>Mastodon generates colorful preview thumbnails for attachments. This is implemented using an extra property <code>blurhash</code> on <code>Image</code> objects. The property is a string generated by the <a href="https://blurha.sh">BlurHash algorithm</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#ff79c6">&#34;@context&#34;</span>: [
    <span style="color:#f1fa8c">&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style="color:#ff79c6">&#34;blurhash&#34;</span>: <span style="color:#f1fa8c">&#34;http://joinmastodon.org/ns#blurhash&#34;</span>
    }
  ],

  <span style="color:#ff79c6">&#34;id&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/@alice/hello-world&#34;</span>,
  <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Note&#34;</span>,
  <span style="color:#ff79c6">&#34;content&#34;</span>: <span style="color:#f1fa8c">&#34;A picture attached!&#34;</span>,
  <span style="color:#ff79c6">&#34;attachment&#34;</span>: [
    {
      <span style="color:#ff79c6">&#34;type&#34;</span>: <span style="color:#f1fa8c">&#34;Image&#34;</span>,
      <span style="color:#ff79c6">&#34;mediaType&#34;</span>: <span style="color:#f1fa8c">&#34;image/png&#34;</span>,
      <span style="color:#ff79c6">&#34;url&#34;</span>: <span style="color:#f1fa8c">&#34;https://example.com/files/cats.png&#34;</span>,
      <span style="color:#ff79c6">&#34;blurhash&#34;</span>: <span style="color:#f1fa8c">&#34;UBL_:rOpGG-oBUNG,qRj2so|=eE1w^n4S5NH&#34;</span>
    }
  ]
}
</code></pre></div><h3 id="sensitive">Sensitive content</h3>
<p>Mastodon uses the <code>as:sensitive</code> extension property to mark certain posts as sensitive. When a post is marked as sensitive, any media attached to it will be hidden by default, and if a <code>summary</code> is present, the status <code>content</code> will be collapsed behind this summary. In Mastodon, this is known as a <strong>content warning</strong>.</p>
<h2 id="other-functionality">Other functionality</h2>
<h3 id="secure-mode">Secure mode</h3>
<p>When a Mastodon server runs in secure mode, all cross-server HTTP requests to it must be signed (in other words, even <code>GET</code> requests to public resources). That way, the Mastodon server can choose to reject requests from servers it has blocked and avoid &ldquo;leaking&rdquo; public information. Mastodon itself uses a dedicated system actor to sign such HTTP requests. See <a href="/spec/security/">Security</a> for more details on HTTP signatures.</p>
<p>Secure mode is the foundation upon which &ldquo;limited federation mode&rdquo; is built. A Mastodon server in limited federation mode will only federate with servers its admin has explicitly allowed, and reject all other requests.</p>
<h3 id="follower-synchronization-mechanism">Follower synchronization mechanism</h3>
<p>Mastodon has a concept of &ldquo;followers-only&rdquo; posts, but expanding the followers collection is currently handled at the destination rather than at the origin (i.e., not with explicit addressing). Therefore, a mechanism to detect synchronization issues and correct them is needed. This mechanism must work on partial followers collections, rather than the full collection (which may not be public information).</p>
<p>When delivering a message to a remote user, an optional <code>Collection-Synchronization</code> HTTP header is attached, following the same syntax as the <code>Signature</code> header, with the following attributes:</p>
<ul>
<li><code>collectionId</code> = MUST be the sender&rsquo;s <code>followers</code> collection</li>
<li><code>url</code> = a URL to a partial collection containing the identifiers of the sender&rsquo;s followers residing on the receiver&rsquo;s instance. MUST reside on the same domain as the actor itself, and SHOULD be only accessible with a signed query from the receiver&rsquo;s instance</li>
<li><code>digest</code> = hexadecimal representation of the XORed SHA256 digests of each of the identifiers in the partial collection</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-http" data-lang="http"><span style="color:#50fa7b">POST</span> https://mastodon.social/users/foo/inbox <span style="color:#ff79c6">HTTP</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">1.1</span>
Collection-Synchronization:
  collectionId=&#34;https://social.sitedethib.com/users/Thib/followers&#34;,
  url=&#34;https://social.sitedethib.com/users/Thib/followers_synchronization&#34;,
  digest=&#34;b08ab6951c7d6cc2b91e17ebd9557da7fae02489728e9332fcb3a97748244d50&#34;
</code></pre></div><p>When a remote user attempts to GET the partial collection <code>url</code>, this request must be signed with HTTP signatures. Example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-http" data-lang="http"><span style="color:#50fa7b">GET</span> https://social.sitedethib.com/users/Thib/followers_synchronization <span style="color:#ff79c6">HTTP</span><span style="color:#ff79c6">/</span><span style="color:#bd93f9">1.1</span>
Signature<span style="color:#ff79c6">:</span> ... # a signature from an account on mastodon.social

{
  &#34;@context&#34;: &#34;https://www.w3.org/ns/activitystreams&#34;,
  &#34;id&#34;: &#34;https://social.sitedethib.com/users/Thib/followers?domain=mastodon.social&#34;,
  &#34;type&#34;: &#34;OrderedCollection&#34;,
  &#34;orderedItems&#34;: [
    &#34;https://mastodon.social/users/Gargron&#34;
  ]
}
</code></pre></div>
    






  
  
  
  
    
    
    
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
      
  
  
  
    
    
    
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
          
            
            
          
            
            
          
            
            
          
            
            
          
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
          
            
            
          
        
      
    
      
        
          
                  
        
      
      
  
  
  
    
    
    
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
      
  
  
  
    
    
    
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
      
  
  
  
    
    
    
    
      
        
          
          
            
            
<div style="margin: 30px 0px">
  <a id="previousLink" href="javascript:void(0)" style="font-size: 12pt">
    <i class="fa fa-arrow-left"></i> Page
  </a>
  <div id="pageTurnSpacer" style="display:inline; margin: 0px 50px"></div>  
  <a id="nextLink" href="javascript:void(0)" style="font-size: 12pt">
    Page <i class="fa fa-arrow-right"></i>
  </a>
</div>
          
        
        
      
    
      
        
          
          
        
        
      
    
      
        
          
          
        
        
      
    
      
        
          
          
        
        
      
    
      
        
          
          
        
        
      
    
      
        
          
          
        
        
      
      
  
  
  
    
    
    
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
      
  
  
  
    
    
    
    
      
        
          
          
            
            
          
            
            
          
        
      
    
      
        
          
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
        
      
    
      
        
          
                  
        
      
    
      
        
          
          
            
            
          
            
            
          
            
            
          
        
      
    
      
        
          
          
            
            
          
            
            
          
            
            
          
            
            
          
        
      
    
      
        
          
          
            
            
          
        
      
    
      
        
          
                  
        
      
    
      
        
          
          
            
            
          
            
            
          
            
            
          
            
            
          
        
      
    
      
        
          
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
      
  
  
  
    
    
    
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
    
      
        
          
                  
        
      
      
  


<script>
 
 
 
 
 
 
 var theMenuTag = "nav";           
 var theMenuSideBar = "sidebar";   
 var theMenuSubMenu = "sub-menu";  
 var theMenuActivePage = "active"; 

 
 
 var previousLink = document.getElementById("previousLink");     
 var nextLink = document.getElementById("nextLink");             
 var pageTurnSpacer = document.getElementById("pageTurnSpacer"); 
 
 
 
 var whatIsActive = -1, prevHref, prevName, nextHref, nextName;

 
 var selectNavs = document.getElementsByTagName(theMenuTag); 
 var selectSidebar;                                          
 for (i = 0; i < selectNavs.length; i++) {                   
   if (selectNavs[i].className == theMenuSideBar) {          
     selectSidebar = selectNavs[i];                          
     break; 
   }
 }

 
 
 var selectSubMenus = selectSidebar.getElementsByClassName(theMenuSubMenu); 
 
 
 for (i = 0; i < selectSubMenus.length; i++) {                      
   let curNavSection = selectSubMenus[i].getElementsByTagName("a"); 
   
   for (j = 0; j < curNavSection.length; j++) {
     if (curNavSection[j].className == theMenuActivePage) { 
      if (j == 0) {                                
        prevHref = "remove";                        
        nextHref = curNavSection[j+1].href;         
        nextName = curNavSection[j+1].innerText;    
        whatIsActive = i; 
      } else if (j == curNavSection.length - 1) {  
        prevHref = curNavSection[j-1].href;         
        prevName = curNavSection[j-1].innerText;    
        nextHref = "remove";                        
        whatIsActive = i; 
      } else {                                     
        prevHref = curNavSection[j-1].href;         
        prevName = curNavSection[j-1].innerText;    
        nextHref = curNavSection[j+1].href;         
        nextName = curNavSection[j+1].innerText;    
        whatIsActive = i; 
      }
       
       break;
     }
   }
   
   if (whatIsActive != -1) { break; }
 }
 
 if (prevHref == "remove") { 
   previousLink.remove();                                             
   pageTurnSpacer.remove();                                           
   nextLink.href = nextHref;                                          
   nextLink.innerHTML = nextLink.innerHTML.replace("Page", nextName); 
 } else if (nextHref == "remove") { 
   previousLink.href = prevHref;                                              
   previousLink.innerHTML = previousLink.innerHTML.replace("Page", prevName); 
   nextLink.remove();                                                         
 } else { 
   previousLink.href = prevHref;                                              
   previousLink.innerHTML = previousLink.innerHTML.replace("Page", prevName); 
   nextLink.href = nextHref;                                                  
   nextLink.innerHTML = nextLink.innerHTML.replace("Page", nextName);         
 }                                                                            
 
</script>

    <p style="color: #687590;">
      Last updated April 11, 2023 · <a href='https://github.com/mastodon/documentation/tree/main/content/en/spec/activitypub.md' style="color: #687590;">Improve this page</a>

      
    </p>

  </div>
</main>
  </div>

  <footer class="footer container">
  <div class="sponsorship">
    <div class="container">
      <h2>
        Sponsored by
      </h2>

      <div class="logo-grid">
        <div>
          <a href="https://www.dotcom-monitor.com/es/">
            <img src="/assets/sponsors/dotcom-monitor-logo.png" alt="Dotcom-Monitor" />
          </a>

          <a href="https://www.loadview-testing.com/products/jmeter-load-testing/">
            <img src="/assets/sponsors/LoadView-logo.png" alt="LoadView" />
          </a>

          <a href="http://www.stevetures.com/">
            <img src="/assets/sponsors/stephen-tures.jpg" alt="Stephen Tures" />
          </a>

          <a href="https://swayable.com">
            <img src="/assets/sponsors/swayable.jpeg" alt="Swayable" />
          </a>

          <a href="https://www.sponsormotion.com/">
            <img src="/assets/sponsors/SponsorMotion.png" alt="SponsorMotion" />
          </a>
        </div>
      </div>
    </div>
  </div>

  <p class="legal legal--right">
    <a href='https://joinmastodon.org'>Join Mastodon</a> · <a href='https://blog.joinmastodon.org'>Blog</a> · <a href='https://mastodon.social/@Mastodon' target='_blank'><i class='fab fa-mastodon'></i></a>
  </p>

  <p class="legal"><a href='https://github.com/mastodon/documentation/tree/main/content/en/spec/activitypub.md'>View source</a> · <a href='https://creativecommons.org/licenses/by-sa/4.0/'>CC BY-SA 4.0</a> · <a href='https://joinmastodon.org/imprint'>Imprint</a></p>
</footer>

</body>

</html>
